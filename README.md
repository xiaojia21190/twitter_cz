# Twitterç›‘æ§ç³»ç»Ÿ

åŸºäºRettiwt-APIæ„å»ºçš„Twitterç§ä¿¡ç¾¤ç»„ç›‘æ§ç³»ç»Ÿï¼Œé€šè¿‡é€šçŸ¥è½®è¯¢æœºåˆ¶ç›‘å¬ç¾¤ç»„ä¸­åˆ†äº«çš„æ¨æ–‡ï¼Œè‡ªåŠ¨ç”ŸæˆAIå›å¤ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ” **å¤šè´¦æˆ·ç›‘æ§**: æ”¯æŒåŒæ—¶ç›‘æ§å¤šä¸ªTwitterè´¦æˆ·
- ğŸŒ **å¤šç¾¤ç»„æ”¯æŒ**: åŒæ—¶ç›‘å¬å¤šä¸ªç¾¤ç»„ï¼Œæ”¯æŒä¼˜å…ˆçº§ç®¡ç†
- ğŸ¯ **æ™ºèƒ½è´Ÿè½½å‡è¡¡**: å¤šè´¦å·è½®æ¢è¯„è®ºï¼Œé¿å…å•è´¦å·é™åˆ¶
- ğŸ¤– **AIè‡ªåŠ¨å›å¤**: é›†æˆOpenAIç”Ÿæˆæ™ºèƒ½å›å¤å†…å®¹
- ğŸ“± **ç¾¤ç»„æ¶ˆæ¯è¯†åˆ«**: æ™ºèƒ½è¯†åˆ«ç§ä¿¡ç¾¤ç»„ä¸­çš„æ¨æ–‡åˆ†äº«
- âš¡ **å®æ—¶ç›‘æ§**: å¯é…ç½®è½®è¯¢é—´éš”ï¼ŒåŠæ—¶å“åº”æ–°æ¶ˆæ¯
- ğŸ”„ **å»é‡æœºåˆ¶**: é¿å…é‡å¤å¤„ç†åŒä¸€æ¨æ–‡
- ğŸ“Š **çŠ¶æ€ç›‘æ§**: å®æ—¶æ˜¾ç¤ºç³»ç»Ÿè¿è¡ŒçŠ¶æ€å’Œç»Ÿè®¡ä¿¡æ¯
- ğŸ›¡ï¸ **é”™è¯¯æ¢å¤**: è‡ªåŠ¨é‡è¿å’Œé”™è¯¯é‡è¯•æœºåˆ¶
- ğŸ› ï¸ **å‘½ä»¤è¡Œç®¡ç†**: ä¾¿æ·çš„è´¦å·å’Œç¾¤ç»„ç®¡ç†å·¥å…·

## æŠ€æœ¯æ ˆ

- **Node.js** >= 18.0.0
- **Rettiwt-API** v5.0.1 - Twitteräº¤äº’
- **axios** - HTTPå®¢æˆ·ç«¯
- **node-cron** - ä»»åŠ¡è°ƒåº¦
- **fs-extra** - æ–‡ä»¶ç³»ç»Ÿæ“ä½œ

## é¡¹ç›®ç»“æ„

```
twitter_monitor/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ auth/              # è®¤è¯ç®¡ç†
â”‚   â”‚   â””â”€â”€ RettwitAuth.js
â”‚   â”œâ”€â”€ notification/      # é€šçŸ¥å¤„ç†
â”‚   â”‚   â””â”€â”€ NotificationProcessor.js
â”‚   â”œâ”€â”€ ai/               # AIå›å¤ç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ OpenAIClient.js
â”‚   â”œâ”€â”€ scheduler/        # ä»»åŠ¡è°ƒåº¦
â”‚   â”‚   â””â”€â”€ MonitorScheduler.js
â”‚   â”œâ”€â”€ config/           # é…ç½®ç®¡ç†
â”‚   â”‚   â””â”€â”€ ConfigLoader.js
â”‚   â”œâ”€â”€ index.js          # åº”ç”¨å…¥å£
â”‚   â””â”€â”€ test.js           # æµ‹è¯•å¥—ä»¶
â”œâ”€â”€ config/               # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ accounts.json     # è´¦æˆ·é…ç½®
â”‚   â””â”€â”€ settings.json     # åº”ç”¨è®¾ç½®
â”œâ”€â”€ data/                 # æ•°æ®å­˜å‚¨
â”œâ”€â”€ logs/                 # æ—¥å¿—æ–‡ä»¶
â”œâ”€â”€ issues/               # é¡¹ç›®è®°å½•
â””â”€â”€ package.json
```

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. é…ç½® Chrome è·¯å¾„ï¼ˆé‡è¦ï¼‰

æœ¬é¡¹ç›®ä½¿ç”¨ `puppeteer-core`ï¼Œéœ€è¦é…ç½® Chrome æµè§ˆå™¨è·¯å¾„ï¼š

```bash
# è‡ªåŠ¨æ£€æµ‹å¹¶é…ç½® Chrome è·¯å¾„ï¼ˆæ¨èï¼‰
npm run chrome:auto

# æˆ–æ‰‹åŠ¨æ£€æµ‹ Chrome è·¯å¾„
npm run chrome:detect

# éªŒè¯é…ç½®
npm run chrome:config
```

è¯¦ç»†é…ç½®è¯´æ˜è¯·å‚è€ƒï¼š[Puppeteer é…ç½®æŒ‡å—](docs/puppeteer-setup.md)

### 3. é…ç½®ç³»ç»Ÿ

#### é…ç½®OpenAIä»£ç†ï¼ˆå¿…éœ€ï¼‰

ç¼–è¾‘ `config/settings.json` ä¸­çš„OpenAIé…ç½®ï¼š

```json
{
  "openai": {
    "proxy_url": "http://your-openai-proxy.com/v1",
    "api_key": "your-openai-api-key",
    "model": "gpt-3.5-turbo"
  }
}
```

æˆ–é€šè¿‡ç¯å¢ƒå˜é‡ï¼š

```bash
export OPENAI_PROXY_URL="http://your-openai-proxy.com/v1"
export OPENAI_API_KEY="your-openai-api-key"
```

#### é…ç½®Twitterè´¦æˆ·ï¼ˆå·²é¢„é…ç½®ï¼‰

è´¦æˆ·é…ç½®å·²åŒ…å«åœ¨ `config/accounts.json` ä¸­ï¼š
- 5ä¸ªTwitterè´¦æˆ·çš„è®¤è¯ä»¤ç‰Œ
- 2ä¸ªS5ä»£ç†æœåŠ¡å™¨é…ç½®
- ä¸ªæ€§åŒ–è½®è¯¢é—´éš”è®¾ç½®

### 3. æµ‹è¯•é…ç½®

```bash
# è¿è¡Œé…ç½®æµ‹è¯•
npm run test

# æˆ–
node src/test.js
```

### 4. å¯åŠ¨ç³»ç»Ÿ

```bash
# ç”Ÿäº§æ¨¡å¼
npm start

# æˆ–å¼€å‘æ¨¡å¼
npm run dev
```

## ä½¿ç”¨æŒ‡å—

### å‘½ä»¤è¡Œé€‰é¡¹

```bash
# æ˜¾ç¤ºå¸®åŠ©
node src/index.js --help

# æŸ¥çœ‹ç‰ˆæœ¬
node src/index.js --version

# æµ‹è¯•é…ç½®
node src/index.js --test

# å¯åŠ¨ç›‘æ§
node src/index.js
```

### å¤šç¾¤ç»„ç®¡ç†

ç³»ç»Ÿæ”¯æŒåŒæ—¶ç›‘å¬å¤šä¸ªç¾¤ç»„ï¼Œæ¯ä¸ªç¾¤ç»„ä½¿ç”¨ç‹¬ç«‹çš„ç›‘æ§è´¦å·ï¼š

```bash
# æŸ¥çœ‹æ‰€æœ‰ç¾¤ç»„
npm run groups:list

# æ·»åŠ æ–°ç¾¤ç»„
npm run accounts group-add <id> <token> <url> <name>

# æ›´æ–°ç¾¤ç»„é…ç½®
npm run accounts group-update <id> <å­—æ®µ=å€¼>

# åˆ é™¤ç¾¤ç»„
npm run accounts group-remove <id>

# æ›´æ–°ç¾¤ç»„é“¾æ¥
npm run accounts group-url <groupId> <url>
```

**ç¤ºä¾‹**ï¼š
```bash
# æ·»åŠ ä¸»è¦ç¾¤ç»„
npm run accounts group-add main_group "auth_token=your_token" "https://x.com/messages/123456" "ä¸»è¦äº¤æµç¾¤"

# è®¾ç½®ä¼˜å…ˆçº§
npm run accounts group-update main_group priority=1

# è°ƒæ•´è½®è¯¢é—´éš”
npm run accounts group-update main_group polling_interval=30000
```

è¯¦ç»†é…ç½®è¯´æ˜è¯·å‚è€ƒï¼š[å¤šç¾¤ç»„é…ç½®æŒ‡å—](docs/multi-group-setup.md)

### ä»£ç†é…ç½®ç®¡ç†

ç³»ç»Ÿæ”¯æŒä¸ºæ¯ä¸ªè´¦å·é…ç½®ç‹¬ç«‹çš„ä»£ç†ï¼Œæé«˜ç¨³å®šæ€§å’Œé¿å…IPé™åˆ¶ï¼š

```bash
# æŸ¥çœ‹æ‰€æœ‰ä»£ç†é…ç½®
npm run proxy:list

# ä¸ºæ‰€æœ‰è´¦å·è®¾ç½®ä»£ç†
npm run proxy:set-all "http://127.0.0.1:7890"

# ä¸ºç‰¹å®šè´¦å·è®¾ç½®ä»£ç†
npm run proxy set-account account_1 "http://127.0.0.1:7890"

# æµ‹è¯•ä»£ç†è¿æ¥
npm run proxy:test "http://127.0.0.1:7890"
```

è¯¦ç»†é…ç½®è¯´æ˜è¯·å‚è€ƒï¼š[ä»£ç†é…ç½®æŒ‡å—](docs/proxy-setup.md)

### ç¯å¢ƒå˜é‡

| å˜é‡å                     | è¯´æ˜             | é»˜è®¤å€¼     |
| -------------------------- | ---------------- | ---------- |
| `OPENAI_PROXY_URL`         | OpenAIä»£ç†åœ°å€   | é…ç½®æ–‡ä»¶å€¼ |
| `OPENAI_API_KEY`           | OpenAI APIå¯†é’¥   | é…ç½®æ–‡ä»¶å€¼ |
| `LOG_LEVEL`                | æ—¥å¿—çº§åˆ«         | info       |
| `DEFAULT_POLLING_INTERVAL` | é»˜è®¤è½®è¯¢é—´éš”(ms) | 30000      |

### ç›‘æ§æœºåˆ¶è¯´æ˜

ç³»ç»Ÿé€šè¿‡ä»¥ä¸‹æ–¹å¼å·¥ä½œï¼š

1. **é€šçŸ¥è½®è¯¢**: å®šæœŸè·å–å„è´¦æˆ·çš„Twitteré€šçŸ¥
2. **ç¾¤ç»„è¯†åˆ«**: è¿‡æ»¤å‡ºæ¥è‡ªç§ä¿¡ç¾¤ç»„çš„é€šçŸ¥
3. **æ¨æ–‡æå–**: ä»é€šçŸ¥ä¸­æå–åˆ†äº«çš„æ¨æ–‡URL
4. **å»é‡å¤„ç†**: é¿å…é‡å¤å¤„ç†åŒä¸€æ¨æ–‡
5. **AIå›å¤**: è°ƒç”¨OpenAIç”Ÿæˆæ™ºèƒ½å›å¤å†…å®¹
6. **è‡ªåŠ¨å‘é€**: å°†AIç”Ÿæˆçš„å›å¤å‘é€åˆ°åŸæ¨æ–‡

### é…ç½®æ–‡ä»¶è¯¦è§£

#### accounts.json

```json
{
  "accounts": [
    {
      "id": "account_1",
      "authToken": "your-auth-token",
      "proxy": {
        "host": "proxy-host",
        "port": 15308,
        "username": "proxy-user",
        "password": "proxy-pass",
        "protocol": "http"
      },
      "enabled": true,
      "polling_interval": 30000
    }
  ]
}
```

#### settings.json

```json
{
  "openai": {
    "proxy_url": "http://your-openai-proxy.com/v1",
    "api_key": "your-api-key",
    "model": "gpt-3.5-turbo",
    "max_tokens": 280,
    "temperature": 0.7
  },
  "monitoring": {
    "tweet_url_regex": "æ­£åˆ™è¡¨è¾¾å¼",
    "processed_tweets_file": "data/processed_tweets.json",
    "max_processed_tweets_cache": 10000
  },
  "notifications": {
    "filter_keywords": ["ç¾¤èŠ", "group", "dm", "ç§ä¿¡"],
    "ignore_own_tweets": true,
    "min_tweet_age_seconds": 60
  }
}
```

## ç›‘æ§çŠ¶æ€

ç³»ç»Ÿè¿è¡Œæ—¶ä¼šå®šæœŸæ˜¾ç¤ºçŠ¶æ€ä¿¡æ¯ï¼š

```
[15:30:25] è¿è¡Œä¸­ | æ´»è·ƒè´¦æˆ·: 5/5 | è¿è¡Œæ—¶é—´: 45åˆ†é’Ÿ | æ€»è½®è¯¢: 150 | å›å¤: 12

ğŸ“ˆ ç³»ç»ŸçŠ¶æ€æŠ¥å‘Š:
   è¿è¡Œæ—¶é—´: 45 åˆ†é’Ÿ
   æ´»è·ƒè´¦æˆ·: 5/5
   æ€»è½®è¯¢æ¬¡æ•°: 150
   æ€»é€šçŸ¥æ•°: 1,245
   å‘ç°æ¨æ–‡: 23
   å‘é€å›å¤: 12
   é”™è¯¯æ¬¡æ•°: 0

ğŸ“± è´¦æˆ·çŠ¶æ€:
   account_1: active (æœ€åè½®è¯¢: 15:30:20)
   account_2: active (æœ€åè½®è¯¢: 15:30:18)
   ...
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **è®¤è¯å¤±è´¥**
   - æ£€æŸ¥authTokenæ˜¯å¦æœ‰æ•ˆ
   - ç¡®è®¤ä»£ç†é…ç½®æ­£ç¡®
   - éªŒè¯ç½‘ç»œè¿æ¥

2. **OpenAI APIé”™è¯¯**
   - ç¡®è®¤ä»£ç†URLå¯è®¿é—®
   - æ£€æŸ¥APIå¯†é’¥æ ¼å¼
   - éªŒè¯æ¨¡å‹åç§°æ­£ç¡®

3. **é€šçŸ¥è·å–å¤±è´¥**
   - å½“å‰Rettiwt-APIç‰ˆæœ¬å¯èƒ½ä¸æ”¯æŒç›´æ¥çš„é€šçŸ¥æ¥å£
   - ç³»ç»Ÿä¼šå°è¯•ä½¿ç”¨æ›¿ä»£æ–¹æ¡ˆ

### æ—¥å¿—æŸ¥çœ‹

ç³»ç»Ÿæ—¥å¿—å­˜å‚¨åœ¨ `logs/` ç›®å½•ä¸‹ï¼š

```bash
# æŸ¥çœ‹æœ€æ–°æ—¥å¿—
tail -f logs/twitter-monitor.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
grep ERROR logs/twitter-monitor.log
```

## å¼€å‘è¯´æ˜

### æŠ€æœ¯é™åˆ¶

ç›®å‰Rettiwt-API v5.0.1çš„å·²çŸ¥é™åˆ¶ï¼š

1. **DMåŠŸèƒ½**: ç¼ºä¹å®Œæ•´çš„ç§ä¿¡ç¾¤ç»„ç›‘æ§API
2. **é€šçŸ¥æ¥å£**: é€šçŸ¥æ¥å£å¯èƒ½ä¸åŒ…å«å®Œæ•´çš„ç¾¤ç»„æ¶ˆæ¯ä¿¡æ¯
3. **è§£å†³æ–¹æ¡ˆ**: ç³»ç»Ÿä½¿ç”¨é€šçŸ¥è½®è¯¢+å…³é”®è¯è¿‡æ»¤çš„å˜é€šæ–¹æ¡ˆ

### æ‰©å±•å¼€å‘

å¦‚éœ€æ‰©å±•åŠŸèƒ½ï¼Œå¯ä»¥ï¼š

1. **å¢å¼ºé€šçŸ¥å¤„ç†**: æ”¹è¿›ç¾¤ç»„æ¶ˆæ¯è¯†åˆ«é€»è¾‘
2. **ä¼˜åŒ–AIå›å¤**: è°ƒæ•´æç¤ºè¯å’Œå›å¤ç­–ç•¥
3. **æ·»åŠ æ–°åŠŸèƒ½**: æ”¯æŒåª’ä½“æ–‡ä»¶ã€è¡¨æƒ…å›åº”ç­‰
4. **ç›‘æ§ç•Œé¢**: å¼€å‘Webæ§åˆ¶å°

### è´¡çŒ®æŒ‡å—

1. Forké¡¹ç›®ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. åˆ›å»ºPull Request

## è®¸å¯è¯

MIT License

## æ”¯æŒ

å¦‚é‡é—®é¢˜ï¼Œè¯·ï¼š

1. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
2. è¿è¡Œæµ‹è¯•å¥—ä»¶
3. æ£€æŸ¥é…ç½®æ–‡ä»¶
4. æäº¤IssueæŠ¥å‘Š

---

**æ³¨æ„**: æœ¬ç³»ç»Ÿéœ€è¦æœ‰æ•ˆçš„Twitterè´¦æˆ·è®¤è¯å’ŒOpenAI APIè®¿é—®æƒé™ã€‚è¯·ç¡®ä¿éµå®ˆç›¸å…³æœåŠ¡çš„ä½¿ç”¨æ¡æ¬¾ã€‚
